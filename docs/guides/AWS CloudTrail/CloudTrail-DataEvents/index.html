<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/AWS CloudTrail/CloudTrail-DataEvents/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">CloudTrail Data Events | AWS Cloud Operations Best Practices</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail-DataEvents/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="CloudTrail Data Events | AWS Cloud Operations Best Practices"><meta data-rh="true" name="description" content="According to the AWS CloudTrail best practices, you should record data events for security-sensitive workloads at a multi-region trail level. For workloads with intensive compliance requirements, we recommend that you enable data events to audit access resource level activity. Logging data events provides the ability to audit at the data level, including changes inside the resource you are enabling visibility."><meta data-rh="true" property="og:description" content="According to the AWS CloudTrail best practices, you should record data events for security-sensitive workloads at a multi-region trail level. For workloads with intensive compliance requirements, we recommend that you enable data events to audit access resource level activity. Logging data events provides the ability to audit at the data level, including changes inside the resource you are enabling visibility."><link data-rh="true" rel="icon" href="/cloud-operations-best-practices/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail-DataEvents/"><link data-rh="true" rel="alternate" href="https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail-DataEvents/" hreflang="en"><link data-rh="true" rel="alternate" href="https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail-DataEvents/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Best practices","item":"https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/"},{"@type":"ListItem","position":2,"name":"AWS CloudTrail","item":"https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/"},{"@type":"ListItem","position":3,"name":"CloudTrail Data Events","item":"https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail-DataEvents/"}]}</script><link rel="stylesheet" href="/cloud-operations-best-practices/assets/css/styles.4d5a722e.css">
<script src="/cloud-operations-best-practices/assets/js/runtime~main.090c0998.js" defer="defer"></script>
<script src="/cloud-operations-best-practices/assets/js/main.9f60db74.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cloud-operations-best-practices/"><b class="navbar__title text--truncate">AWS Cloud Operations Best Practices</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/home">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/guides/">Guides</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/solutions/">Solutions</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/recipes/">Recipes</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/faq/">FAQ</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/contributors">Contributors</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/resources/">Resources</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail-DataEvents/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><a href="https://github.com/aws-samples/cloud-operations-best-practices" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cloud-operations-best-practices/docs/home"><span title="What is AWS Cloud Operations" class="linkLabel_WmDU">What is AWS Cloud Operations</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/cloud-operations-best-practices/docs/guides/"><span title="Best practices" class="categoryLinkLabel_W154">Best practices</span></a><button aria-label="Collapse sidebar category &#x27;Best practices&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/"><span title="AWS CloudTrail" class="categoryLinkLabel_W154">AWS CloudTrail</span></a><button aria-label="Collapse sidebar category &#x27;AWS CloudTrail&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/Operating CloudTrail/"><span title="Operating CloudTrail" class="linkLabel_WmDU">Operating CloudTrail</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Trails/"><span title="CloudTrail Trails" class="linkLabel_WmDU">CloudTrail Trails</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Lake/"><span title="CloudTrail Lake" class="categoryLinkLabel_W154">CloudTrail Lake</span></a><button aria-label="Expand sidebar category &#x27;CloudTrail Lake&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" aria-current="page" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail-DataEvents/"><span title="CloudTrail Data Events" class="categoryLinkLabel_W154">CloudTrail Data Events</span></a><button aria-label="Collapse sidebar category &#x27;CloudTrail Data Events&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail-DataEvents/cloudtrail-advanced-event-selectors-guide"><span title="Advanced Event Selectors" class="linkLabel_WmDU">Advanced Event Selectors</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Network Activity Events/"><span title="CloudTrail Network Activity Events" class="linkLabel_WmDU">CloudTrail Network Activity Events</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS Config/"><span title="AWS Config" class="categoryLinkLabel_W154">AWS Config</span></a><button aria-label="Expand sidebar category &#x27;AWS Config&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS Control Tower/"><span title="AWS Control Tower" class="categoryLinkLabel_W154">AWS Control Tower</span></a><button aria-label="Expand sidebar category &#x27;AWS Control Tower&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS Region Usage/"><span title="AWS Region Usage" class="categoryLinkLabel_W154">AWS Region Usage</span></a><button aria-label="Expand sidebar category &#x27;AWS Region Usage&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/guides/application-operations/"><span title="Application Operations" class="categoryLinkLabel_W154">Application Operations</span></a><button aria-label="Expand sidebar category &#x27;Application Operations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/guides/centralized-operations-management/"><span title="Centralized Operations Management" class="categoryLinkLabel_W154">Centralized Operations Management</span></a><button aria-label="Expand sidebar category &#x27;Centralized Operations Management&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cloud-operations-best-practices/docs/solutions/"><span title="Solutions" class="categoryLinkLabel_W154">Solutions</span></a><button aria-label="Expand sidebar category &#x27;Solutions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cloud-operations-best-practices/docs/recipes/"><span title="Recipes" class="categoryLinkLabel_W154">Recipes</span></a><button aria-label="Expand sidebar category &#x27;Recipes&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cloud-operations-best-practices/docs/faq/"><span title="FAQ" class="categoryLinkLabel_W154">FAQ</span></a><button aria-label="Expand sidebar category &#x27;FAQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cloud-operations-best-practices/docs/resources/"><span title="Resources" class="linkLabel_WmDU">Resources</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cloud-operations-best-practices/docs/contributors"><span title="Contributors" class="linkLabel_WmDU">Contributors</span></a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cloud-operations-best-practices/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cloud-operations-best-practices/docs/guides/"><span>Best practices</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/"><span>AWS CloudTrail</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">CloudTrail Data Events</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>CloudTrail Data Events</h1></header>
<p>According to the AWS CloudTrail best practices, you should record data events for security-sensitive workloads at a multi-region trail level. For workloads with intensive compliance requirements, we recommend that you enable data events to audit access resource level activity. Logging data events provides the ability to audit at the data level, including changes inside the resource you are enabling visibility.</p>
<p>CloudTrail helps by providing added observability and supports data events for a wide variety of services. These data events can be used to help you meet your critical compliance, risk, and security objectives. Some examples of these type of events include object-level API activities such as delete, update, and put items. Examples of the enhanced visibility provided by CloudTrail data events include API activity on an agent alias or knowledge base in Amazon Bedrock, activity on an application or data source in Amazon Q Business, or Sagemaker API activity on a feature store. These deliver key risk management benefits such as:</p>
<ul>
<li class="">Monitoring access to personal data and sensitive information</li>
<li class="">Visibility into personal data and sensitive data modifications</li>
<li class="">Auditing activities in applications that handle personal data and sensitive information</li>
<li class="">Detecting potential data breaches and privacy incidents</li>
<li class="">Facilitating privacy audits and compliance reporting*</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="advanced-event-selectors-for-data-events">Advanced Event Selectors for Data Events<a href="#advanced-event-selectors-for-data-events" class="hash-link" aria-label="Direct link to Advanced Event Selectors for Data Events" title="Direct link to Advanced Event Selectors for Data Events" translate="no">​</a></h3>
<p>When you use data events, advanced event selectors offer greater control over which CloudTrail events are ingested into your event data stores. With advanced event selectors, you can include or exclude values on fields such as EventSource, EventName, userIdentity.arn, and ResourceARN. Advanced event selectors also support including or excluding values with pattern matching on partial strings. This increases the efficiency and precision of your security, compliance, and operational investigations while helping reduce costs. For example, you can filter CloudTrail events based on the userIdentity.arn attribute to exclude events generated by specific IAM roles or users. You can exclude a dedicated IAM role used by a service that performs frequent API calls for monitoring purposes. This allows you to significantly reduce the volume of CloudTrail events ingested into CloudTrail Lake, lowering costs while maintaining visibility into relevant user and system activities.</p>
<p><img decoding="async" loading="lazy" alt="CloudTrail Lake Data Events" src="/cloud-operations-best-practices/assets/images/cloudtrail-data-events-advanced-selector-c19c260063cf659e962a2014e0887456.png" title="Advanced Event Selectors for Data Events" width="1486" height="699" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="workload-specific"><strong>Workload Specific</strong><a href="#workload-specific" class="hash-link" aria-label="Direct link to workload-specific" title="Direct link to workload-specific" translate="no">​</a></h3>
<p>The following sections will provide some best practices on monitoring and auditing specific workloads using the resource types available for trails and event data stores.  For example, when logging data events for Amazon S3 you would want to capture <code>PutObject</code> API operations to record all resource level operations that are being made to Amazon S3 objects.  This would provide visibility on actions done at the resource level for Amazon S3 objects.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="amazon-sns-and-amazon-sqs"><strong>Amazon SNS and Amazon SQS</strong><a href="#amazon-sns-and-amazon-sqs" class="hash-link" aria-label="Direct link to amazon-sns-and-amazon-sqs" title="Direct link to amazon-sns-and-amazon-sqs" translate="no">​</a></h3>
<p>According to the Amazon SNS security best practices and Amazon SQS security best practices it recommends to consider using VPC endpoints to access Amazon SNS and Amazon SQS. For example, if you have Amazon SNS topics or Amazon SQS queues that you must be able to interact with, but which must absolutely not be exposed to the internet, using VPC endpoints to control access to only the hosts within a particular VPC to publish or send messages to an Amazon SNS topic or Amazon SQS queue.</p>
<p>Enabling data events for Amazon SNS in CloudTrail you will be able to audit <code>Publish</code> and <code>PublishBatch</code> API actions for all your Amazon SNS topics.  Similarly, for <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-logging-using-cloudtrail.html#sqs-data-events-in-cloud-trail" target="_blank" rel="noopener noreferrer" class="">data events for Amazon SQS</a> ensure that the <code>SendMessage</code> API action will audit that VPC Endpoints are being used when sending messages to Amazon SQS queues from instances within your VPC, without traversing the internet.</p>
<p>The below query will show API actions for the <a href="https://docs.aws.amazon.com/sns/latest/api/API_Publish.html" target="_blank" rel="noopener noreferrer" class="">Publish</a> events from Amazon SNS, indicating messages where being published to an Amazon SNS topic. The results will also show which <a href="https://aws.amazon.com/iam/" target="_blank" rel="noopener noreferrer" class="">IAM</a> entity took this action and the specific VPC endpoint ID the message was sent. However, if there is no VPC endpoint ID then the Publish API call was made without using a VPC Endpoint.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="sql-query">SQL Query:<a href="#sql-query" class="hash-link" aria-label="Direct link to SQL Query:" title="Direct link to SQL Query:" translate="no">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT eventTime,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    substr(userIdentity.arn, strpos(userIdentity.arn, &#x27;/&#x27;) +1) as IAM, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    recipientAccountId, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    awsRegion, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    eventName,sourceIPAddress, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    substr(element_At(requestParameters, &#x27;topicArn&#x27;), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    strpos(element_At(requestParameters, &#x27;topicArn&#x27;), &#x27;.com/&#x27;) +18) as Topic, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vpcEndpointId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM $EDS_ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WHERE eventSource = &#x27;sns.amazonaws.com&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AND eventName = &#x27;Publish&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AND eventtime &gt;= &#x27;2024-06-24 00:00:00&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AND eventtime &lt;= &#x27;2024-06-24 23:59:59&#x27;</span><br></span></code></pre></div></div>
<p>Similarly as what was shown for the Amazon SNS query, the below query will show API actions for the <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/API_SendMessage.html" target="_blank" rel="noopener noreferrer" class="">SendMessage</a> events from Amazon SQS, indicating messages were being sent to a specific Amazon SQS queue. These results will also show which <a href="https://aws.amazon.com/iam/" target="_blank" rel="noopener noreferrer" class="">IAM</a> entity took the action and the specific VPC endpoint ID to which the message was sent.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="sql-query-1">SQL Query:<a href="#sql-query-1" class="hash-link" aria-label="Direct link to SQL Query:" title="Direct link to SQL Query:" translate="no">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT eventTime, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    substr(userIdentity.arn, strpos(userIdentity.arn, &#x27;/&#x27;) +1) as IAM, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    recipientAccountId, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    awsRegion, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    eventName,sourceIPAddress, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    substr(element_At(requestParameters, &#x27;queueUrl&#x27;), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    strpos(element_At(requestParameters, &#x27;queueUrl&#x27;), &#x27;.com/&#x27;) +18) as Queue, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vpcEndpointId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM $EDS_ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE eventSource = &#x27;sqs.amazonaws.com&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AND eventName = &#x27;SendMessage&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AND eventtime &gt;= &#x27;2024-06-24 00:00:00&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AND eventtime &lt;= &#x27;2024-06-24 23:59:59&#x27;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="amazon-q-for-business">Amazon Q for Business<a href="#amazon-q-for-business" class="hash-link" aria-label="Direct link to Amazon Q for Business" title="Direct link to Amazon Q for Business" translate="no">​</a></h3>
<p>For Amazon Q for Business workloads you can configure the data events for <strong>AWS::QBusiness::Application</strong> and <strong>AWS::S3::Object</strong>.  The <strong>AWS::QBusiness::Application</strong> logs data plane activities related to our Amazon Q Business application and the <strong>AWS::S3::Object</strong> records data events for the source Amazon S3 bucket.  Once the data events are configured for your trail or event data store, then the events will start to be generated for Amazon Q Business and Amazon S3.</p>
<p>The below query will show API calls to <a href="https://docs.aws.amazon.com/amazonq/latest/api-reference/API_BatchDeleteDocument.html" target="_blank" rel="noopener noreferrer" class="">BatchDeleteDocument</a> indicating deletion of one or more documents which was used in our Amazon Q Business Application.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="sql-query-2">SQL Query:<a href="#sql-query-2" class="hash-link" aria-label="Direct link to SQL Query:" title="Direct link to SQL Query:" translate="no">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    eventName, COUNT(*) AS numberOfCallsFROM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;event-data-store-ID&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    eventSource=&#x27;qbusiness.amazonaws.com&#x27; AND eventTime &gt; date_add(&#x27;day&#x27;, -1, now())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BY eventName ORDER BY COUNT(*) DESC</span><br></span></code></pre></div></div>
<p>The below query will help to find the IAM identity associated with the BatchDeleteDocument API call.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="sql-query-3">SQL Query:<a href="#sql-query-3" class="hash-link" aria-label="Direct link to SQL Query:" title="Direct link to SQL Query:" translate="no">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sourceIPAddress, eventTime, userIdentity.principalid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> FROM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &lt;event-data-store-ID&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WHERE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> eventName=&#x27;BatchDeleteDocument&#x27; AND eventTime &gt; date_add(&#x27;day&#x27;, -1, now())</span><br></span></code></pre></div></div>
<p>The below query which job triggered the synchronization of the S3 data source with the Amazon Q Business Applications by looking for the StartDataSourceSyncJob API call.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="sql-query-4">SQL Query:<a href="#sql-query-4" class="hash-link" aria-label="Direct link to SQL Query:" title="Direct link to SQL Query:" translate="no">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sourceIPAddress, eventTime, userIdentity.arn AS user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> FROM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &lt;event-data-store-ID&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WHERE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> eventName=&#x27;StartDataSourceSyncJob&#x27; AND eventTime &gt; date_add(&#x27;day&#x27;, -1, now())</span><br></span></code></pre></div></div>
<p>The following query will show if any objects were deleted from the S3 bucket that is connected as a data source to our Q business application by checking for DeleteObject API event:</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="sql-query-5">SQL Query:<a href="#sql-query-5" class="hash-link" aria-label="Direct link to SQL Query:" title="Direct link to SQL Query:" translate="no">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sourceIPAddress, eventTime, userIdentity.arn AS user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> FROM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &lt;event-data-store-ID&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> WHERE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> userIdentity.arn IS NOT NULL AND eventName=&#x27;DeleteObject&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> AND element_at(requestParameters, &#x27;bucketName&#x27;) like &#x27;&lt;enter-S3-bucket-name&gt;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> AND eventTime &gt; &#x27;[2024-05-09 00](tel:2024050900):00:00’</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="amazon-q-developer">Amazon Q Developer<a href="#amazon-q-developer" class="hash-link" aria-label="Direct link to Amazon Q Developer" title="Direct link to Amazon Q Developer" translate="no">​</a></h3>
<p>One of the events you can track using data events for Amazon Q Developer is  <strong>‘StartCodeAnalysis’</strong>, which tracks security scans performed by Amazon Q Developer for VS Code and JetBrains IDEs.</p>
<p>The below query we will retrieve a list of all users who initiated a security scan.  This will help identify which users utilize Amazon Q Developer to analyze code within your organization and determine the source of their requests</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userIdentity.onbehalfof.userid, eventTime, SourceIPAddress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;event-data-store-ID&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    eventName = &#x27;StartCodeAnalysis&#x27;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="amazon-bedrock">Amazon Bedrock<a href="#amazon-bedrock" class="hash-link" aria-label="Direct link to Amazon Bedrock" title="Direct link to Amazon Bedrock" translate="no">​</a></h3>
<p>CloudTrail data events for Amazon Bedrock track API events for Agents for Bedrock and Amazon Bedrock knowledge bases through the ‘AWS::Bedrock::AgentAlias’ and ‘AWS::Bedrock::KnowledgeBase’ resource type actions.</p>
<p>For example, if the administrator of a chat application wants to audit the events related to Bedrock agents’ invocation, they can use the following query, which will help determine the details on <a href="https://docs.aws.amazon.com/bedrock/latest/APIReference/API_agent-runtime_InvokeAgent.html#API_agent-runtime_InvokeAgent_RequestSyntax" target="_blank" rel="noopener noreferrer" class="">request</a> and <a href="https://docs.aws.amazon.com/bedrock/latest/APIReference/API_agent-runtime_InvokeAgent.html#API_agent-runtime_InvokeAgent_ResponseSyntax" target="_blank" rel="noopener noreferrer" class="">response</a> parameters sent along with the invoked agent alias.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UserIdentity,eventTime,eventName,UserAgent,requestParameters,resourcesFROM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;event-data-store-ID&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    eventName = &#x27;InvokeAgent&#x27;</span><br></span></code></pre></div></div>
<p>Additionally, the below query will provide details on the invoked knowledge base, along with the returned request and response parameters:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UserIdentity,eventTime,eventName,UserAgent,requestParameters,resourcesFROM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;event-data-store-ID&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WHERE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    eventName = &#x27;RetrieveAndGenerate&#x27;</span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Lake/CloudTrail Lake Event Enrichment/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Best Practices for CloudTrail Lake event enrichment</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail-DataEvents/cloudtrail-advanced-event-selectors-guide"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Advanced Event Selectors</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#advanced-event-selectors-for-data-events" class="table-of-contents__link toc-highlight">Advanced Event Selectors for Data Events</a></li><li><a href="#workload-specific" class="table-of-contents__link toc-highlight"><strong>Workload Specific</strong></a></li><li><a href="#amazon-sns-and-amazon-sqs" class="table-of-contents__link toc-highlight"><strong>Amazon SNS and Amazon SQS</strong></a></li><li><a href="#amazon-q-for-business" class="table-of-contents__link toc-highlight">Amazon Q for Business</a></li><li><a href="#amazon-q-developer" class="table-of-contents__link toc-highlight">Amazon Q Developer</a></li><li><a href="#amazon-bedrock" class="table-of-contents__link toc-highlight">Amazon Bedrock</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Built with ❤️ at AWS. <br> © 2025.  Amazon.com, Inc. or its affiliates. All Rights Reserved.</div></div></div></footer></div>
</body>
</html>