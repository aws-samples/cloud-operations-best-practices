<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/AWS CloudTrail/CloudTrail Lake/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">CloudTrail Lake | AWS Cloud Operations Best Practices</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Lake/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="CloudTrail Lake | AWS Cloud Operations Best Practices"><meta data-rh="true" name="description" content="CloudTrail Lake aggregates, immutably stores, and queries ingested events, offering a managed data lake for your organization. Your organization can use these events for auditing, security investigations and operational investigations. CloudTrail Lake simplifies analysis workflows by integrating collection, storage, preparation, and optimization for analysis and querying within CloudTrail. The following will outline some best practices around CloudTrail Lake."><meta data-rh="true" property="og:description" content="CloudTrail Lake aggregates, immutably stores, and queries ingested events, offering a managed data lake for your organization. Your organization can use these events for auditing, security investigations and operational investigations. CloudTrail Lake simplifies analysis workflows by integrating collection, storage, preparation, and optimization for analysis and querying within CloudTrail. The following will outline some best practices around CloudTrail Lake."><link data-rh="true" rel="icon" href="/cloud-operations-best-practices/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Lake/"><link data-rh="true" rel="alternate" href="https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Lake/" hreflang="en"><link data-rh="true" rel="alternate" href="https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Lake/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Best practices","item":"https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/"},{"@type":"ListItem","position":2,"name":"AWS CloudTrail","item":"https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/"},{"@type":"ListItem","position":3,"name":"CloudTrail Lake","item":"https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Lake/"}]}</script><link rel="stylesheet" href="/cloud-operations-best-practices/assets/css/styles.16d755e3.css">
<script src="/cloud-operations-best-practices/assets/js/runtime~main.a5f04e15.js" defer="defer"></script>
<script src="/cloud-operations-best-practices/assets/js/main.b4949ad7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cloud-operations-best-practices/"><b class="navbar__title text--truncate">AWS Cloud Operations Best Practices</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/home">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/guides/">Guides</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/solutions/">Solutions</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/recipes/">Recipes</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/faq/">FAQ</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/contributors">Contributors</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/resources/">Resources</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Lake/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><a href="https://github.com/aws-samples/cloud-operations-best-practices" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cloud-operations-best-practices/docs/home">What is AWS Cloud Operations</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/cloud-operations-best-practices/docs/guides/">Best practices</a><button aria-label="Collapse sidebar category &#x27;Best practices&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/">AWS CloudTrail</a><button aria-label="Collapse sidebar category &#x27;AWS CloudTrail&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/Operating CloudTrail/">Operating CloudTrail</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Trails/">CloudTrail Trails</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Lake/">CloudTrail Lake</a><button aria-label="Collapse sidebar category &#x27;CloudTrail Lake&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Lake/CloudTrail Lake Event Enrichment/">Best Practices for CloudTrail Lake event enrichment</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail-DataEvents/">CloudTrail Data Events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Network Activity Events/">CloudTrail Network Activity Events</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS Config/">AWS Config</a><button aria-label="Expand sidebar category &#x27;AWS Config&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/guides/application-operations/">Application Operations</a><button aria-label="Expand sidebar category &#x27;Application Operations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/guides/centralized-operations-management/">Centralized Operations Management</a><button aria-label="Expand sidebar category &#x27;Centralized Operations Management&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/cloud-operations-best-practices/docs/solutions/">Solutions</a><button aria-label="Expand sidebar category &#x27;Solutions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/cloud-operations-best-practices/docs/recipes/">Recipes</a><button aria-label="Expand sidebar category &#x27;Recipes&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/cloud-operations-best-practices/docs/faq/">FAQ</a><button aria-label="Expand sidebar category &#x27;FAQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cloud-operations-best-practices/docs/resources/">Resources</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cloud-operations-best-practices/docs/contributors">Contributors</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cloud-operations-best-practices/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cloud-operations-best-practices/docs/guides/"><span>Best practices</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/"><span>AWS CloudTrail</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">CloudTrail Lake</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>CloudTrail Lake</h1></header>
<p>CloudTrail Lake aggregates, immutably stores, and queries ingested events, offering a managed data lake for your organization. Your organization can use these events for auditing, security investigations and operational investigations. CloudTrail Lake simplifies analysis workflows by integrating collection, storage, preparation, and optimization for analysis and querying within CloudTrail. The following will outline some best practices around CloudTrail Lake.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="choosing-a-right-pricing-option">Choosing a right pricing option<a href="#choosing-a-right-pricing-option" class="hash-link" aria-label="Direct link to Choosing a right pricing option" title="Direct link to Choosing a right pricing option">​</a></h3>
<p>When creating your event data store, you want to choose a pricing option that fits the type and amount of events you expect to ingest monthly.  For most, the One-year extendable retention pricing option is the most cost-effective approach.  However, if you will be ingesting more the 25 TB of data a month, then the Seven-year retention pricing option may be a better choice.</p>
<p><img decoding="async" loading="lazy" alt="CloudTrail Lake Pricing Option" src="/cloud-operations-best-practices/assets/images/price-option-eds-33b8c9a6d482c06774555650ade67907.png" title="CloudTrail Lake Pricing Option" width="1374" height="670" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lake-query-federation">Lake query Federation<a href="#lake-query-federation" class="hash-link" aria-label="Direct link to Lake query Federation" title="Direct link to Lake query Federation">​</a></h3>
<p>We recommend enabling Lake query Federation, which will allow you to configure your event data store for zero-ETL analysis from Athena.  This will help removes the operational complexities of building data processing pipelines to be able to correlate activity logs with application logs or Cost and Usage data stored in S3.  This will also allow you to run cross join queries within Athena against your other data sets. Enabling this feature will also remove the need to replicate or move your CloudTrail data since it provides a federate link to your event data store using LakeFormation.  With this feature you can also use LakeFormation to create data filters and share subset of your data within your event data store to other accounts within your organization.  For more information please take a look at the blog: <a href="https://aws.amazon.com/blogs/mt/securely-share-aws-cloudtrail-lake-logs-across-accounts-without-replicating-data/" target="_blank" rel="noopener noreferrer">Securely share AWS CloudTrail Lake logs across accounts without replicating data</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-resource-based-policies">Configure Resource based policies<a href="#configure-resource-based-policies" class="hash-link" aria-label="Direct link to Configure Resource based policies" title="Direct link to Configure Resource based policies">​</a></h3>
<p>You can configure resource based policies to grant permissions to other IAM principals.  This would allow you to share your EDS to other member accounts to query the CloudTrail data.   This can help avoid the need to duplicate or copy events to other accounts since you can grant specific IAM principles access to query the event data store.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-tags-for-your-event-data-store">Configure Tags for your event data store<a href="#configure-tags-for-your-event-data-store" class="hash-link" aria-label="Direct link to Configure Tags for your event data store" title="Direct link to Configure Tags for your event data store">​</a></h3>
<p>Adding tags to your event data store can allow you to track the query and ingestion costs for your CloudTrail Lake event data if you add these tags as user defined cost allocation tags.  Another use case for tags for your event data store would be for adding an resource based IAM policy defining who can manage or query an event data store.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ingest-data-events-for-your-event-data-store">Ingest data events for your event data store<a href="#ingest-data-events-for-your-event-data-store" class="hash-link" aria-label="Direct link to Ingest data events for your event data store" title="Direct link to Ingest data events for your event data store">​</a></h3>
<p>Data events provide visibility into the resource operations performed on or in the resource.  CloudTrail data events supports various resource types for a full list of supported resource types, please take a look at the doc <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/logging-data-events-with-cloudtrail.html#logging-data-events" target="_blank" rel="noopener noreferrer">CloudTrail data events</a>. These events are also known as data plane operations. Data events are often high-volume activities, especially if you are storing sensitive data on S3 or have key business operations occurring through Lambda functions. Visibility into any unexpected access to sensitive data lets you take corrective action to protect your data. Because some compliance reports (for example, FedRAMP and PCI-DSS ) require data events to be turned on, AWS recommends that you use AWS Config managed rules or an appropriate Conformance Pack Sample Templates to check that at least one trail is logging S3 data events for all S3 buckets.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="import-historical-cloudtrail-trail-events">Import historical CloudTrail Trail events<a href="#import-historical-cloudtrail-trail-events" class="hash-link" aria-label="Direct link to Import historical CloudTrail Trail events" title="Direct link to Import historical CloudTrail Trail events">​</a></h3>
<p>When migrating from CloudTrail Trails to CloudTrail Lake, use the Copy Trail event feature to copy existing trail events to your CloudTrail Lake event data store which were recorded prior to event data store creation. This will allow you to import events from an Amazon Simple Storage Service (Amazon S3) buckets corresponding to a CloudTrail trail into a CloudTrail Lake EDS.  However, when using this feature its recommended to specify an import date range, so that you only import the subset of logs that are needed for long-term storage and analysis in Lake.  This will help prevent additional costs related to importing of logs outside of the date range specified.</p>
<p><img decoding="async" loading="lazy" alt="CloudTrail Lake Copy trail events" src="/cloud-operations-best-practices/assets/images/copy-trail-eds-1e202394a6747b32d91f7b0388a68416.png" title="CloudTrail Lake Copy trail events" width="1650" height="627" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="enhanced-filtering-options-for-cloudtrail-events-ingested-into-event-data-stores">Enhanced filtering options for CloudTrail events ingested into event data stores<a href="#enhanced-filtering-options-for-cloudtrail-events-ingested-into-event-data-stores" class="hash-link" aria-label="Direct link to Enhanced filtering options for CloudTrail events ingested into event data stores" title="Direct link to Enhanced filtering options for CloudTrail events ingested into event data stores">​</a></h3>
<p>Enhanced event filtering capabilities give you greater control over which CloudTrail events are ingested into your event data stores. These enhanced filtering options provide tighter control over your AWS activity data, improving the efficiency and precision of security, compliance, and operational investigations. Additionally, the new filtering options help you reduce your analysis workflow costs by ingesting only the most relevant event data into your CloudTrail Lake event data stores.</p>
<p>You can filter management events by using the Advanced Event Collection and filter events to included or excluded based on attributes such as eventSource, eventType, eventName, userIdentity.arn, and sessionCredentialFromConsole.</p>
<p>When you use data events, we recommend using advanced event selectors which offer greater control over which CloudTrail events are ingested into your event data stores. With advanced event selectors, you can include or exclude values on fields such as EventSource, EventName, userIdentity.arn, and ResourceARN. Advanced event selectors also support including or excluding values with pattern matching on partial strings.</p>
<p>Using enhanced filters for CloudTrail will help increase the efficiency and precision of your security, compliance, and operational investigations while helping reduce costs. For example, you can filter CloudTrail events based on the userIdentity.arn attribute to exclude events generated by specific IAM roles or users. You can exclude a dedicated IAM role used by a service that performs frequent API calls for monitoring purposes. This allows you to significantly reduce the volume of CloudTrail events ingested into CloudTrail Lake, lowering costs while maintaining visibility into relevant user and system activities.</p>
<p><img decoding="async" loading="lazy" alt="CloudTrail Lake Data Events" src="/cloud-operations-best-practices/assets/images/cloudtrail-data-events-advanced-selector-c19c260063cf659e962a2014e0887456.png" title="Advanced Event Selectors for Data Events" width="1486" height="699" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sql-queries">SQL Queries<a href="#sql-queries" class="hash-link" aria-label="Direct link to SQL Queries" title="Direct link to SQL Queries">​</a></h3>
<p>When running SQL queries, we recommend that you constrain queries by adding starting and ending eventTime time stamps to queries.  This will help minimize the cost when data is scanned for queries.  You can do this by adding the eventtime field in the where clause, adding time range that will be searched with the time range you want to use. The date string specified after eventTime &gt; is the earliest event timestamp that will be included, while the date string specified after eventTime &lt; is the latest event timestamp that will be included. The following query is a sample showing the usage of the eventtime field.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> eventTime</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> useridentity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> awsRegion </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> $EDS_ID </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> eventTime </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2024-07-20 00:00:00&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> eventTime </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2024-07-23 00:00:00&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> awsRegion </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;us-east-1&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> eventName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ConsoleLogin&#x27;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="natural-language-prompts">Natural language prompts<a href="#natural-language-prompts" class="hash-link" aria-label="Direct link to Natural language prompts" title="Direct link to Natural language prompts">​</a></h3>
<p>Use the Natural Language query processor to help you get started in analyzing your activity logs (management and data events) stored in CloudTrail Lake without having to write a SQL query or spend time in understanding the SQL syntax needed to query your activity events.  NLQ can also be helpful you to get quicker insights into your data by asking what you would like to query and then it providing the SQL query to use.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cloudtrail-query-results-integrity-validation">CloudTrail query results integrity validation<a href="#cloudtrail-query-results-integrity-validation" class="hash-link" aria-label="Direct link to CloudTrail query results integrity validation" title="Direct link to CloudTrail query results integrity validation">​</a></h3>
<p>CloudTrail Lake query results integrity validation lets you know if the query results where modified, deleted or changed when the results were exported. By validating the query results, allows you to asset that no changes were made to the exported results file delivered by CloudTrail. To validate the results, you can use the <strong>verify-query-results</strong> AWS cli command to verify the hash value of each query result file to the hash value in the signed file.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setup-cloudwatch-alerts-to-monitor-cloudtrail-lake-usage">Setup CloudWatch alerts to monitor CloudTrail Lake usage<a href="#setup-cloudwatch-alerts-to-monitor-cloudtrail-lake-usage" class="hash-link" aria-label="Direct link to Setup CloudWatch alerts to monitor CloudTrail Lake usage" title="Direct link to Setup CloudWatch alerts to monitor CloudTrail Lake usage">​</a></h3>
<p>You can create alarms and notification on the supported CloudWatch metrics for CloudTrail Lake to help track your event data store usage over a period of time.  You can then setup alerts to notify you when it has passed a certain threshold.  With CloudWatch you can mornitor metrics such as HourlyDataIngested, TotalDataRetained, TotalStorageBytes &amp; TotalPaidStorageBytes to help you gain further visibility to your overall data usage for CloudTrail Lake.  For example, you can create a CloudWatch Dashboard showing you CloudTrail Lake Event Data Store Size.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SORT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SEARCH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;{AWS/CloudTrail,&quot;Event data store ID&quot;,&quot;Lake Metrics&quot;} MetricName=&quot;TotalPaidStorageBytes&quot; NOT &quot;Lake Metrics&quot;=&quot;IngestionMetrics&quot;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;Sum&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">SUM</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DESC</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="CloudTrail Lake Event Data Store Size" src="/cloud-operations-best-practices/assets/images/cloudtrail-lake-storage-size-4c8d62ab2137107e7ee67ff89cce7e3c.png" title="CloudTrail Lake Event Data Store Size" width="553" height="461" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cloudtrail-lake-dashboards">CloudTrail Lake Dashboards<a href="#cloudtrail-lake-dashboards" class="hash-link" aria-label="Direct link to CloudTrail Lake Dashboards" title="Direct link to CloudTrail Lake Dashboards">​</a></h3>
<p>We recommend enabling CloudTrail Lake dashboards to visulize your event trends of the data stored in your event data stores in CloudTrail Lake.  The Highlights dashboard will provide an overall easy-to-view summary of the data captured in CloudTrail Lake. This will provide a dahsboard to quickly identify and understand important insights within your event data store, such as the top failed API calls, trends in failed login attempts, and spikes in resource creation.  The CloudTrail Lake dashboards also provide other managed dashboards specific to an AWS service that will provide further insights around this service. You can also create a custom dashboard showing your own widgets or specific widgets from any of the managed dashboards.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Trails/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">CloudTrail Trails</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Lake/CloudTrail Lake Event Enrichment/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Best Practices for CloudTrail Lake event enrichment</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#choosing-a-right-pricing-option" class="table-of-contents__link toc-highlight">Choosing a right pricing option</a></li><li><a href="#lake-query-federation" class="table-of-contents__link toc-highlight">Lake query Federation</a></li><li><a href="#configure-resource-based-policies" class="table-of-contents__link toc-highlight">Configure Resource based policies</a></li><li><a href="#configure-tags-for-your-event-data-store" class="table-of-contents__link toc-highlight">Configure Tags for your event data store</a></li><li><a href="#ingest-data-events-for-your-event-data-store" class="table-of-contents__link toc-highlight">Ingest data events for your event data store</a></li><li><a href="#import-historical-cloudtrail-trail-events" class="table-of-contents__link toc-highlight">Import historical CloudTrail Trail events</a></li><li><a href="#enhanced-filtering-options-for-cloudtrail-events-ingested-into-event-data-stores" class="table-of-contents__link toc-highlight">Enhanced filtering options for CloudTrail events ingested into event data stores</a></li><li><a href="#sql-queries" class="table-of-contents__link toc-highlight">SQL Queries</a></li><li><a href="#natural-language-prompts" class="table-of-contents__link toc-highlight">Natural language prompts</a></li><li><a href="#cloudtrail-query-results-integrity-validation" class="table-of-contents__link toc-highlight">CloudTrail query results integrity validation</a></li><li><a href="#setup-cloudwatch-alerts-to-monitor-cloudtrail-lake-usage" class="table-of-contents__link toc-highlight">Setup CloudWatch alerts to monitor CloudTrail Lake usage</a></li><li><a href="#cloudtrail-lake-dashboards" class="table-of-contents__link toc-highlight">CloudTrail Lake Dashboards</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Built with ❤️ at AWS. <br> © 2025.  Amazon.com, Inc. or its affiliates. All Rights Reserved.</div></div></div></footer></div>
</body>
</html>