<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/AWS CloudTrail/cloudtrail-mcp-server-guide/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Using the CloudTrail MCP Server for Security, Audit, and Operations | AWS Cloud Operations Best Practices</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/cloudtrail-mcp-server-guide/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Using the CloudTrail MCP Server for Security, Audit, and Operations | AWS Cloud Operations Best Practices"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="icon" href="/cloud-operations-best-practices/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/cloudtrail-mcp-server-guide/"><link data-rh="true" rel="alternate" href="https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/cloudtrail-mcp-server-guide/" hreflang="en"><link data-rh="true" rel="alternate" href="https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/cloudtrail-mcp-server-guide/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Best practices","item":"https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/"},{"@type":"ListItem","position":2,"name":"AWS CloudTrail","item":"https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/"},{"@type":"ListItem","position":3,"name":"Using the CloudTrail MCP Server for Security, Audit, and Operations","item":"https://aws-samples.github.io/cloud-operations-best-practices/docs/guides/AWS CloudTrail/cloudtrail-mcp-server-guide/"}]}</script><link rel="stylesheet" href="/cloud-operations-best-practices/assets/css/styles.3097b0a4.css">
<script src="/cloud-operations-best-practices/assets/js/runtime~main.f4f71ddf.js" defer="defer"></script>
<script src="/cloud-operations-best-practices/assets/js/main.06d55f9a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cloud-operations-best-practices/"><b class="navbar__title text--truncate">AWS Cloud Operations Best Practices</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/home">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/guides/">Guides</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/solutions/">Solutions</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/recipes/">Recipes</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/faq/">FAQ</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/contributors">Contributors</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/resources/">Resources</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/cloudtrail-mcp-server-guide/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><a href="https://github.com/aws-samples/cloud-operations-best-practices" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cloud-operations-best-practices/docs/home"><span title="What is AWS Cloud Operations" class="linkLabel_WmDU">What is AWS Cloud Operations</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/cloud-operations-best-practices/docs/guides/"><span title="Best practices" class="categoryLinkLabel_W154">Best practices</span></a><button aria-label="Collapse sidebar category &#x27;Best practices&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/"><span title="AWS CloudTrail" class="categoryLinkLabel_W154">AWS CloudTrail</span></a><button aria-label="Collapse sidebar category &#x27;AWS CloudTrail&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/Operating CloudTrail/"><span title="Operating CloudTrail" class="linkLabel_WmDU">Operating CloudTrail</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Trails/"><span title="CloudTrail Trails" class="linkLabel_WmDU">CloudTrail Trails</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Lake/"><span title="CloudTrail Lake" class="categoryLinkLabel_W154">CloudTrail Lake</span></a><button aria-label="Expand sidebar category &#x27;CloudTrail Lake&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail-DataEvents/"><span title="CloudTrail Data Events" class="categoryLinkLabel_W154">CloudTrail Data Events</span></a><button aria-label="Expand sidebar category &#x27;CloudTrail Data Events&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Network Activity Events/"><span title="CloudTrail Network Activity Events" class="linkLabel_WmDU">CloudTrail Network Activity Events</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/cloudtrail-mcp-server-guide/"><span title="Using the CloudTrail MCP Server for Security, Audit, and Operations" class="linkLabel_WmDU">Using the CloudTrail MCP Server for Security, Audit, and Operations</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS Config/"><span title="AWS Config" class="categoryLinkLabel_W154">AWS Config</span></a><button aria-label="Expand sidebar category &#x27;AWS Config&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS Control Tower/"><span title="AWS Control Tower" class="categoryLinkLabel_W154">AWS Control Tower</span></a><button aria-label="Expand sidebar category &#x27;AWS Control Tower&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/guides/AWS Region Usage/"><span title="AWS Region Usage" class="categoryLinkLabel_W154">AWS Region Usage</span></a><button aria-label="Expand sidebar category &#x27;AWS Region Usage&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/guides/application-operations/"><span title="Application Operations" class="categoryLinkLabel_W154">Application Operations</span></a><button aria-label="Expand sidebar category &#x27;Application Operations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/guides/centralized-operations-management/"><span title="Centralized Operations Management" class="categoryLinkLabel_W154">Centralized Operations Management</span></a><button aria-label="Expand sidebar category &#x27;Centralized Operations Management&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cloud-operations-best-practices/docs/solutions/"><span title="Solutions" class="categoryLinkLabel_W154">Solutions</span></a><button aria-label="Expand sidebar category &#x27;Solutions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cloud-operations-best-practices/docs/recipes/"><span title="Recipes" class="categoryLinkLabel_W154">Recipes</span></a><button aria-label="Expand sidebar category &#x27;Recipes&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cloud-operations-best-practices/docs/faq/"><span title="FAQ" class="categoryLinkLabel_W154">FAQ</span></a><button aria-label="Expand sidebar category &#x27;FAQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cloud-operations-best-practices/docs/resources/"><span title="Resources" class="categoryLinkLabel_W154">Resources</span></a><button aria-label="Expand sidebar category &#x27;Resources&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cloud-operations-best-practices/docs/contributors"><span title="Contributors" class="linkLabel_WmDU">Contributors</span></a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cloud-operations-best-practices/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cloud-operations-best-practices/docs/guides/"><span>Best practices</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/"><span>AWS CloudTrail</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Using the CloudTrail MCP Server for Security, Audit, and Operations</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Using the CloudTrail MCP Server for Security, Audit, and Operations</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction" translate="no">​</a></h2>
<p>The <a href="https://awslabs.github.io/mcp/servers/cloudtrail-mcp-server" target="_blank" rel="noopener noreferrer" class="">CloudTrail Model Context Protocol (MCP)</a> server enables agents like <a href="https://kiro.dev/cli/" target="_blank" rel="noopener noreferrer" class="">Kiro</a> to query and analyze <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-user-guide.html" target="_blank" rel="noopener noreferrer" class="">AWS CloudTrail</a> events directly through natural language. By connecting your agents to CloudTrail events in either <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html" target="_blank" rel="noopener noreferrer" class="">CloudWatch Logs</a> or <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-lake.html" target="_blank" rel="noopener noreferrer" class="">CloudTrail Lake</a>, you can investigate security incidents, audit account activity, troubleshoot operational issues, and generate compliance reports—all through conversational prompts instead of writing complex SQL queries or manually parsing JSON logs.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-this-matters">Why This Matters<a href="#why-this-matters" class="hash-link" aria-label="Direct link to Why This Matters" title="Direct link to Why This Matters" translate="no">​</a></h2>
<p>Security, compliance, and operations teams spend significant time analyzing CloudTrail logs to understand AWS account activity:</p>
<ul>
<li class=""><strong>Security teams</strong> need to quickly investigate suspicious activity, trace unauthorized access attempts, and identify the scope of potential security incidents across multiple accounts</li>
<li class=""><strong>Compliance teams</strong> must generate audit reports showing who accessed what resources, when changes were made, and whether activities comply with organizational policies</li>
<li class=""><strong>Operations teams</strong> troubleshoot service disruptions by tracing API calls, identifying configuration changes, and understanding the sequence of events leading to issues</li>
<li class=""><strong>All teams</strong> struggle with CloudWatch Logs Insights query syntax, JSON parsing, and correlating events across time periods and accounts</li>
</ul>
<p>Without the CloudTrail MCP server, teams resort to writing complex queries, manually parsing JSON logs, or building custom dashboards—adding time, complexity, and potential for human error to critical security and operational workflows.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="how-it-works">How It Works<a href="#how-it-works" class="hash-link" aria-label="Direct link to How It Works" title="Direct link to How It Works" translate="no">​</a></h2>
<p>The CloudTrail MCP server translates natural language questions into queries against your CloudTrail data, executes them, and returns human-readable results with context and insights.</p>
<p><strong>Supported Data Sources:</strong></p>
<ul>
<li class=""><strong>CloudWatch Logs</strong>: Uses <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/CWL_QuerySyntax.html" target="_blank" rel="noopener noreferrer" class="">CloudWatch Logs Insights query syntax</a> - MCP server automatically discovers available log groups</li>
<li class=""><strong>CloudTrail Lake</strong>: Uses <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/query-create-edit-query.html" target="_blank" rel="noopener noreferrer" class="">SQL queries</a> - MCP server automatically discovers available event data stores for CloudTrail Lake</li>
</ul>
<p><strong>Key Capabilities:</strong></p>
<ul>
<li class="">Natural language queries instead of writing query syntax</li>
<li class="">Multi-account support</li>
<li class="">Time-based analysis and event correlation</li>
<li class="">Security investigation, compliance reporting, and operational troubleshooting</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="setup-requirements">Setup Requirements<a href="#setup-requirements" class="hash-link" aria-label="Direct link to Setup Requirements" title="Direct link to Setup Requirements" translate="no">​</a></h2>
<p>To use the CloudTrail MCP server, you need:</p>
<p><strong>For CloudWatch Logs:</strong></p>
<ul>
<li class=""><a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html" target="_blank" rel="noopener noreferrer" class="">AWS CloudTrail configured to send events to CloudWatch Logs</a></li>
<li class="">IAM permissions: <code>logs:StartQuery</code>, <code>logs:GetQueryResults</code>, <code>logs:DescribeLogGroups</code></li>
<li class="">MCP server will automatically discover available CloudTrail log groups</li>
</ul>
<p><strong>For CloudTrail Lake:</strong></p>
<ul>
<li class=""><a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/query-event-data-store.html" target="_blank" rel="noopener noreferrer" class="">CloudTrail Lake event data store</a> created and configured</li>
<li class="">IAM permissions: <code>cloudtrail:StartQuery</code>, <code>cloudtrail:GetQueryResults</code>, <code>cloudtrail:DescribeEventDataStores</code>, <code>cloudtrail:ListEventDataStores</code> (see <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/lake-permissions.html" target="_blank" rel="noopener noreferrer" class="">CloudTrail Lake permissions</a>)</li>
<li class="">MCP server will automatically discover available CloudTrail Lake event data stores</li>
</ul>
<p><strong>For Both:</strong></p>
<ul>
<li class="">MCP server configured in your agent</li>
<li class="">AWS credentials with appropriate permissions</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration" translate="no">​</a></h2>
<p>To configure the CloudTrail MCP server in your agent, follow the setup instructions in the <a href="https://awslabs.github.io/mcp/" target="_blank" rel="noopener noreferrer" class="">AWS MCP Servers Documentation</a>. The MCP server automatically discovers available CloudTrail data sources (CloudWatch Logs and CloudTrail Lake) in your AWS account.</p>
<p><strong>In your prompts</strong>, you can optionally specify which data source to query:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Using CloudWatch Logs, show me all failed login attempts in the last 24 hours.</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Using CloudTrail Lake, show me all IAM policy changes in the last 90 days.</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="sample-prompts-for-real-world-tasks">Sample Prompts for Real-World Tasks<a href="#sample-prompts-for-real-world-tasks" class="hash-link" aria-label="Direct link to Sample Prompts for Real-World Tasks" title="Direct link to Sample Prompts for Real-World Tasks" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="security-investigation-prompts">Security Investigation Prompts<a href="#security-investigation-prompts" class="hash-link" aria-label="Direct link to Security Investigation Prompts" title="Direct link to Security Investigation Prompts" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-investigate-failed-login-attempts">1. Investigate Failed Login Attempts<a href="#1-investigate-failed-login-attempts" class="hash-link" aria-label="Direct link to 1. Investigate Failed Login Attempts" title="Direct link to 1. Investigate Failed Login Attempts" translate="no">​</a></h4>
<p><strong>Prompt:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Show me all failed console login attempts in the last 24 hours. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Include the username, source IP address, and timestamp.</span><br></span></code></pre></div></div>
<p><strong>What it does:</strong> Identifies potential brute force attacks or compromised credentials by analyzing <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-event-reference-record-contents.html" target="_blank" rel="noopener noreferrer" class="">CloudTrail event records</a></p>
<p><strong>Use case:</strong> Security team receives alert about multiple failed logins and needs to assess threat level</p>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-identify-privilege-escalation">2. Identify Privilege Escalation<a href="#2-identify-privilege-escalation" class="hash-link" aria-label="Direct link to 2. Identify Privilege Escalation" title="Direct link to 2. Identify Privilege Escalation" translate="no">​</a></h4>
<p><strong>Prompt:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Show me all IAM policy changes in the last 48 hours. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Focus on policies that grant admin permissions or modify IAM roles.</span><br></span></code></pre></div></div>
<p><strong>What it does:</strong> Detects potential privilege escalation attempts</p>
<p><strong>Use case:</strong> Security team investigates whether an actor gained elevated permissions</p>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="compliance-and-audit-prompts">Compliance and Audit Prompts<a href="#compliance-and-audit-prompts" class="hash-link" aria-label="Direct link to Compliance and Audit Prompts" title="Direct link to Compliance and Audit Prompts" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-generate-user-activity-report">3. Generate User Activity Report<a href="#3-generate-user-activity-report" class="hash-link" aria-label="Direct link to 3. Generate User Activity Report" title="Direct link to 3. Generate User Activity Report" translate="no">​</a></h4>
<p><strong>Prompt:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Generate a complete audit report for IAM user demo.user for the month of January 2024. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Include all API calls, resources accessed, and any permission changes.</span><br></span></code></pre></div></div>
<p><strong>What it does:</strong> Creates comprehensive user activity audit trail</p>
<p><strong>Use case:</strong> Need to provide a timeline of activity for a certain period</p>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-track-mfa-usage">4. Track MFA Usage<a href="#4-track-mfa-usage" class="hash-link" aria-label="Direct link to 4. Track MFA Usage" title="Direct link to 4. Track MFA Usage" translate="no">​</a></h4>
<p><strong>Prompt:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Show me all console logins in the last month. Which users logged in without MFA? </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">How many times did each user login?</span><br></span></code></pre></div></div>
<p><strong>What it does:</strong> Validates MFA compliance across organization</p>
<p><strong>Use case:</strong> Security policy requires MFA for all users; identify non-compliant accounts</p>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="operational-troubleshooting-prompts">Operational Troubleshooting Prompts<a href="#operational-troubleshooting-prompts" class="hash-link" aria-label="Direct link to Operational Troubleshooting Prompts" title="Direct link to Operational Troubleshooting Prompts" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="5-investigate-service-outage">5. Investigate Service Outage<a href="#5-investigate-service-outage" class="hash-link" aria-label="Direct link to 5. Investigate Service Outage" title="Direct link to 5. Investigate Service Outage" translate="no">​</a></h4>
<p><strong>Prompt:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Our application stopped working at 2024-01-15 14:30 UTC. Show me all API calls </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">related to our production VPC (vpc-abc123) in the 30 minutes before the outage. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">What changed?</span><br></span></code></pre></div></div>
<p><strong>What it does:</strong> Identifies configuration changes that caused service disruption</p>
<p><strong>Use case:</strong> Operations team needs to quickly identify root cause of outage</p>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="6-debug-iam-permission-issues">6. Debug IAM Permission Issues<a href="#6-debug-iam-permission-issues" class="hash-link" aria-label="Direct link to 6. Debug IAM Permission Issues" title="Direct link to 6. Debug IAM Permission Issues" translate="no">​</a></h4>
<p><strong>Prompt:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">User reports they can&#x27;t create EC2 instances. Show me all EC2 RunInstances calls </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from user demo.user in the last 2 hours, including any access denied errors. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">What permissions are missing?</span><br></span></code></pre></div></div>
<p><strong>What it does:</strong> Diagnoses IAM permission problems</p>
<p><strong>Use case:</strong> User can&#x27;t perform required tasks; identify missing permissions</p>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="advanced-multi-account-prompts">Advanced Multi-Account Prompts<a href="#advanced-multi-account-prompts" class="hash-link" aria-label="Direct link to Advanced Multi-Account Prompts" title="Direct link to Advanced Multi-Account Prompts" translate="no">​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="7-cross-account-security-review">7. Cross-Account Security Review<a href="#7-cross-account-security-review" class="hash-link" aria-label="Direct link to 7. Cross-Account Security Review" title="Direct link to 7. Cross-Account Security Review" translate="no">​</a></h4>
<p><strong>Prompt:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Across all our AWS accounts, show me any security group rules that allow inbound </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">traffic from 0.0.0.0/0 on ports other than 80 and 443. When were these rules created </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">and by whom?</span><br></span></code></pre></div></div>
<p><strong>What it does:</strong> Identifies security risks across entire AWS organization</p>
<p><strong>Use case:</strong> Security team conducts organization-wide security posture review</p>
<p><strong>Note:</strong> Requires CloudTrail Lake with <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-lake-organizations.html" target="_blank" rel="noopener noreferrer" class="">organization event data store</a> for multi-account queries or a organization trail delivered to CloudWatch Logs.</p>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="8-compliance-across-accounts">8. Compliance Across Accounts<a href="#8-compliance-across-accounts" class="hash-link" aria-label="Direct link to 8. Compliance Across Accounts" title="Direct link to 8. Compliance Across Accounts" translate="no">​</a></h4>
<p><strong>Prompt:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">For production accounts (account IDs: 111111111111, 222222222222, 333333333333), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show me any CloudTrail configuration changes in the last year. Has logging ever </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">been disabled?</span><br></span></code></pre></div></div>
<p><strong>What it does:</strong> Validates audit logging compliance across organization</p>
<p><strong>Use case:</strong> Compliance audit requires proof of continuous logging</p>
<hr>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="combining-cloudtrail-with-vpc-flow-logs">Combining CloudTrail with VPC Flow Logs<a href="#combining-cloudtrail-with-vpc-flow-logs" class="hash-link" aria-label="Direct link to Combining CloudTrail with VPC Flow Logs" title="Direct link to Combining CloudTrail with VPC Flow Logs" translate="no">​</a></h3>
<p>When both CloudTrail and <a href="https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html" target="_blank" rel="noopener noreferrer" class="">VPC Flow Logs</a> are sent to CloudWatch Logs, you can correlate API actions with network traffic for comprehensive security investigations.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="9-troubleshoot-connectivity-issues">9. Troubleshoot Connectivity Issues<a href="#9-troubleshoot-connectivity-issues" class="hash-link" aria-label="Direct link to 9. Troubleshoot Connectivity Issues" title="Direct link to 9. Troubleshoot Connectivity Issues" translate="no">​</a></h4>
<p><strong>Prompt:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Application team reports connectivity issues to RDS database at 10:15 AM today. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Check VPC Flow Logs for rejected connections to the database subnet around that time, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">then check CloudTrail for any security group, NACL, or route table changes in the </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">30 minutes before the issue started.</span><br></span></code></pre></div></div>
<p><strong>What it does:</strong> Identifies whether connectivity issues stem from configuration changes or network problems</p>
<p><strong>Use case:</strong> Operations team needs to quickly resolve application outage</p>
<hr>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="10-detect-lateral-movement">10. Detect Lateral Movement<a href="#10-detect-lateral-movement" class="hash-link" aria-label="Direct link to 10. Detect Lateral Movement" title="Direct link to 10. Detect Lateral Movement" translate="no">​</a></h4>
<p><strong>Prompt:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CloudTrail shows user demo.user assumed role &quot;ProductionAdmin&quot; at 2:30 PM. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Check VPC Flow Logs for all network connections initiated from instances </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">accessed by that role in the following hour. Are there any unusual internal </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connections or port scans?</span><br></span></code></pre></div></div>
<p><strong>What it does:</strong> Identifies potential lateral movement after privilege escalation</p>
<p><strong>Use case:</strong> Security team investigates whether compromised credentials were used to access additional resources</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices" translate="no">​</a></h2>
<p><strong>Effective Prompts:</strong></p>
<ul>
<li class="">Be specific with time ranges and include context (account IDs, resource names, user identities)</li>
<li class="">Ask follow-up questions to refine results</li>
<li class="">Request actionable insights: &quot;what should I do?&quot; or &quot;is this normal?&quot;</li>
</ul>
<p><strong>Query Optimization:</strong></p>
<ul>
<li class="">Start broad, then narrow down</li>
<li class="">Use resource identifiers for faster results</li>
<li class="">Combine related questions in one prompt</li>
</ul>
<p><strong>Security:</strong></p>
<ul>
<li class="">Protect sensitive data in query results</li>
<li class="">Validate findings through multiple data points</li>
<li class="">Limit MCP server access to authorized users</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion" translate="no">​</a></h2>
<p>The CloudTrail MCP server transforms CloudTrail event analysis from a technical query-writing task into a natural conversation with your agents. Security teams can investigate incidents faster, compliance teams can generate audit reports effortlessly, and operations teams can troubleshoot issues without learning complex query syntax.</p>
<p>Start with the basic prompts for your most common tasks—investigating failed logins, tracking IAM changes, or troubleshooting outages—then adapt them to your specific environment. The conversational nature of the MCP server means you can refine your questions iteratively, getting more precise answers as you explore your CloudTrail data.</p>
<p>For more information, see the <a href="https://awslabs.github.io/mcp/" target="_blank" rel="noopener noreferrer" class="">AWS MCP Servers Documentation</a> and <a href="https://kiro.dev/docs/mcp/" target="_blank" rel="noopener noreferrer" class="">MCP for Kiro</a>.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cloud-operations-best-practices/docs/guides/AWS CloudTrail/CloudTrail Network Activity Events/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">CloudTrail Network Activity Events</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cloud-operations-best-practices/docs/guides/AWS Config/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">AWS Config</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#why-this-matters" class="table-of-contents__link toc-highlight">Why This Matters</a></li><li><a href="#how-it-works" class="table-of-contents__link toc-highlight">How It Works</a></li><li><a href="#setup-requirements" class="table-of-contents__link toc-highlight">Setup Requirements</a></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a></li><li><a href="#sample-prompts-for-real-world-tasks" class="table-of-contents__link toc-highlight">Sample Prompts for Real-World Tasks</a><ul><li><a href="#security-investigation-prompts" class="table-of-contents__link toc-highlight">Security Investigation Prompts</a></li><li><a href="#compliance-and-audit-prompts" class="table-of-contents__link toc-highlight">Compliance and Audit Prompts</a></li><li><a href="#operational-troubleshooting-prompts" class="table-of-contents__link toc-highlight">Operational Troubleshooting Prompts</a></li><li><a href="#advanced-multi-account-prompts" class="table-of-contents__link toc-highlight">Advanced Multi-Account Prompts</a></li><li><a href="#combining-cloudtrail-with-vpc-flow-logs" class="table-of-contents__link toc-highlight">Combining CloudTrail with VPC Flow Logs</a></li></ul></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Built with ❤️ at AWS. <br> © 2026.  Amazon.com, Inc. or its affiliates. All Rights Reserved.</div></div></div></footer></div>
</body>
</html>