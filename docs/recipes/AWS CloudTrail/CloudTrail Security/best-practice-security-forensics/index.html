<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-recipes/AWS CloudTrail/CloudTrail Security/best-practice-security-forensics" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Best Practices for Security Forensics | AWS Cloud Operations Best Practices</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://aws-samples.github.io/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/CloudTrail Security/best-practice-security-forensics"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Best Practices for Security Forensics | AWS Cloud Operations Best Practices"><meta data-rh="true" name="description" content="Security forensics and incident response are vital cybersecurity practices for identifying, investigating, and mitigating IT security incidents. Forensics systematically collects and analyzes digital evidence, like logs and system artifacts, to uncover details of a breach. Incident response focuses on detecting, containing, and remediating incidents to minimize damage and prevent recurrence. Together, they help organizations understand breaches, attribute actions, and ensure compliance with regulations. Implementing CloudTrail best practices enhances logging, analysis, and timely remediation for effective security forensics and incident response."><meta data-rh="true" property="og:description" content="Security forensics and incident response are vital cybersecurity practices for identifying, investigating, and mitigating IT security incidents. Forensics systematically collects and analyzes digital evidence, like logs and system artifacts, to uncover details of a breach. Incident response focuses on detecting, containing, and remediating incidents to minimize damage and prevent recurrence. Together, they help organizations understand breaches, attribute actions, and ensure compliance with regulations. Implementing CloudTrail best practices enhances logging, analysis, and timely remediation for effective security forensics and incident response."><link data-rh="true" rel="icon" href="/cloud-operations-best-practices/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://aws-samples.github.io/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/CloudTrail Security/best-practice-security-forensics"><link data-rh="true" rel="alternate" href="https://aws-samples.github.io/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/CloudTrail Security/best-practice-security-forensics" hreflang="en"><link data-rh="true" rel="alternate" href="https://aws-samples.github.io/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/CloudTrail Security/best-practice-security-forensics" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Recipes","item":"https://aws-samples.github.io/cloud-operations-best-practices/docs/recipes/"},{"@type":"ListItem","position":2,"name":"AWS CloudTrail","item":"https://aws-samples.github.io/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/"},{"@type":"ListItem","position":3,"name":"Security Incident Response and Forensic Analysis","item":"https://aws-samples.github.io/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/CloudTrail Security/"},{"@type":"ListItem","position":4,"name":"Best Practices for Security Forensics","item":"https://aws-samples.github.io/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/CloudTrail Security/best-practice-security-forensics"}]}</script><link rel="stylesheet" href="/cloud-operations-best-practices/assets/css/styles.16d755e3.css">
<script src="/cloud-operations-best-practices/assets/js/runtime~main.b747f3c6.js" defer="defer"></script>
<script src="/cloud-operations-best-practices/assets/js/main.b4949ad7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cloud-operations-best-practices/"><b class="navbar__title text--truncate">AWS Cloud Operations Best Practices</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/home">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/guides/">Guides</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/solutions/">Solutions</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/recipes/">Recipes</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/faq/">FAQ</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/contributors">Contributors</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cloud-operations-best-practices/docs/resources/">Resources</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/CloudTrail Security/best-practice-security-forensics" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><a href="https://github.com/aws-samples/cloud-operations-best-practices" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cloud-operations-best-practices/docs/home">What is AWS Cloud Operations</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/cloud-operations-best-practices/docs/guides/">Best practices</a><button aria-label="Expand sidebar category &#x27;Best practices&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/cloud-operations-best-practices/docs/solutions/">Solutions</a><button aria-label="Expand sidebar category &#x27;Solutions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/cloud-operations-best-practices/docs/recipes/">Recipes</a><button aria-label="Collapse sidebar category &#x27;Recipes&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/">AWS CloudTrail</a><button aria-label="Collapse sidebar category &#x27;AWS CloudTrail&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/CloudTrail Security/">Security Incident Response and Forensic Analysis</a><button aria-label="Collapse sidebar category &#x27;Security Incident Response and Forensic Analysis&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/CloudTrail Security/event-fields">Understand the Security Importance of CloudTrail Event Fields</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/CloudTrail Security/best-practice-security-forensics">Best Practices for Security Forensics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/CloudTrail Security/additional-resources">AWS CloudTrail Security Resources</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-operations-best-practices/docs/recipes/application-operations/">Application Operations</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/cloud-operations-best-practices/docs/recipes/centralized-operations-management/">Centralized Operations Management</a><button aria-label="Expand sidebar category &#x27;Centralized Operations Management&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/cloud-operations-best-practices/docs/faq/">FAQ</a><button aria-label="Expand sidebar category &#x27;FAQ&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cloud-operations-best-practices/docs/resources/">Resources</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cloud-operations-best-practices/docs/contributors">Contributors</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cloud-operations-best-practices/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cloud-operations-best-practices/docs/recipes/"><span>Recipes</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/"><span>AWS CloudTrail</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/CloudTrail Security/"><span>Security Incident Response and Forensic Analysis</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Best Practices for Security Forensics</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Best Practices for Security Forensics</h1></header>
<p>Security forensics and incident response are vital cybersecurity practices for identifying, investigating, and mitigating IT security incidents. Forensics systematically collects and analyzes digital evidence, like logs and system artifacts, to uncover details of a breach. Incident response focuses on detecting, containing, and remediating incidents to minimize damage and prevent recurrence. Together, they help organizations understand breaches, attribute actions, and ensure compliance with regulations. Implementing CloudTrail best practices enhances logging, analysis, and timely remediation for effective security forensics and incident response.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Strengthen Your AWS Security Services.</div><div class="admonitionContent_BuS1"><p>To strengthen your AWS security services, enhance your implementation strategy, and effectively protect your valuable cloud resources,
<strong>explore the latest <a href="https://aws.github.io/aws-security-services-best-practices/" target="_blank" rel="noopener noreferrer">AWS Security Services Best Practices</a></strong>.
Learn how to validate your security configurations, implement proven techniques, and adopt community-contributed best practices for a robust security posture.</p></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Strengthen Your CloudTrail Security</div><div class="admonitionContent_BuS1"><p>To enhance your AWS CloudTrail setup and protect activity logs during incident investigations, <strong>explore the latest <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/best-practices-security.html" target="_blank" rel="noopener noreferrer">AWS CloudTrail Security Best Practices</a></strong>. Learn how to secure event data stores, enable encryption, and restrict access for a robust security posture.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="comprehensive-logging-configuration">Comprehensive Logging Configuration<a href="#comprehensive-logging-configuration" class="hash-link" aria-label="Direct link to Comprehensive Logging Configuration" title="Direct link to Comprehensive Logging Configuration">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="enable-comprehensive-logging-across-all-regions-and-accounts">Enable Comprehensive Logging Across All Regions and Accounts<a href="#enable-comprehensive-logging-across-all-regions-and-accounts" class="hash-link" aria-label="Direct link to Enable Comprehensive Logging Across All Regions and Accounts" title="Direct link to Enable Comprehensive Logging Across All Regions and Accounts">​</a></h3>
<p>Configure CloudTrail to log management, data, and network activity events in all AWS Regions and accounts within your organization. Use multi-Region trails or organizational trails to capture all API activities, including global service events (e.g., IAM, Route 53).</p>
<p><strong>Benefits</strong>: Ensures no events are missed, enabling detection of unauthorized actions in unused regions or accounts.</p>
<p><strong>Example</strong>: Unexpected activity in a dormant region may indicate attacker reconnaissance.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-advanced-event-selectors-to-focus-on-high-risk-data-events">Use Advanced Event Selectors to Focus on High-Risk Data Events<a href="#use-advanced-event-selectors-to-focus-on-high-risk-data-events" class="hash-link" aria-label="Direct link to Use Advanced Event Selectors to Focus on High-Risk Data Events" title="Direct link to Use Advanced Event Selectors to Focus on High-Risk Data Events">​</a></h3>
<p>Configure advanced event selectors to log high-risk data events, such as S3 DeleteObject or Lambda InvokeFunction calls, while excluding high-volume, low-risk events to reduce costs.</p>
<p><strong>Benefits</strong>: Focuses forensic analysis on critical activities while controlling costs.</p>
<p><strong>Example</strong>: Use selectors to log only DeleteObject events for specific S3 buckets containing sensitive data, as shown in the query:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">event</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">data</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">store</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ID</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> eventName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;DeleteObject&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> resources</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ARN </span><span class="token operator" style="color:#393A34">LIKE</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;arn:aws:s3:::sensitive-bucket%&#x27;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="log-analysis-and-querying">Log Analysis and Querying<a href="#log-analysis-and-querying" class="hash-link" aria-label="Direct link to Log Analysis and Querying" title="Direct link to Log Analysis and Querying">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-cloudtrail-lake-for-advanced-querying">Use CloudTrail Lake for Advanced Querying<a href="#use-cloudtrail-lake-for-advanced-querying" class="hash-link" aria-label="Direct link to Use CloudTrail Lake for Advanced Querying" title="Direct link to Use CloudTrail Lake for Advanced Querying">​</a></h3>
<p>Leverage CloudTrail Lake to run SQL-based queries on event data stores, enabling rapid analysis of large log volumes.</p>
<p><strong>Benefits</strong>: Enables efficient filtering of events by fields like eventName, userIdentity.arn, or sourceIPAddress to identify malicious activities.</p>
<p><strong>Example Query</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> eventTime</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> userIdentity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> eventName </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">event</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">data</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">store</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ID</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> eventName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;CreateAccessKey&#x27;</span><br></span></code></pre></div></div>
<p><strong>Best Practice</strong>: Store events in CloudTrail Lake for longer than the default 90 days to support extended investigations.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="integrate-with-amazon-athena-for-efficient-log-analysis">Integrate with Amazon Athena for Efficient Log Analysis<a href="#integrate-with-amazon-athena-for-efficient-log-analysis" class="hash-link" aria-label="Direct link to Integrate with Amazon Athena for Efficient Log Analysis" title="Direct link to Integrate with Amazon Athena for Efficient Log Analysis">​</a></h3>
<p>Use Amazon Athena to query CloudTrail logs stored in S3, leveraging partitioned tables to reduce query costs and improve performance.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Automate CloudTrail Analysis</div><div class="admonitionContent_BuS1"><p><strong>Explore <a href="https://github.com/aws-samples/sample-automation-cloudtrail-athena" target="_blank" rel="noopener noreferrer">AWS CloudTrail Athena Automation Scripts</a></strong> on GitHub to streamline incident investigations with pre-built queries and automation for CloudTrail and Athena integration.</p></div></div>
<p><strong>Benefits</strong>: Enables targeted queries on specific accounts, regions, or times periods.</p>
<p><strong>Example Query</strong>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> trail_123456789012 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> eventName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;DeleteObject&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> eventTime </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2025-05-01&#x27;</span><br></span></code></pre></div></div>
<p><strong>Implementation</strong>: Create account-specific and organization-wide tables partitioned by account, region, and date.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Access Saved Security Queries</div><div class="admonitionContent_BuS1"><p><strong>Enhance your incident investigations</strong> with pre-built Athena queries for AWS CloudTrail. <strong><a href="https://github.com/awslabs/aws-security-analytics-bootstrap/blob/main/AWSSecurityAnalyticsBootstrap/sql/dml/analytics/cloudtrail/cloudtrail_demo_queries.sql" target="_blank" rel="noopener noreferrer">Explore saved security incident queries</a></strong> on GitHub to streamline analysis of CloudTrail logs in Athena tables.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-and-detection">Monitoring and Detection<a href="#monitoring-and-detection" class="hash-link" aria-label="Direct link to Monitoring and Detection" title="Direct link to Monitoring and Detection">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="enable-cloudtrail-insights-for-anomaly-detection">Enable CloudTrail Insights for Anomaly Detection<a href="#enable-cloudtrail-insights-for-anomaly-detection" class="hash-link" aria-label="Direct link to Enable CloudTrail Insights for Anomaly Detection" title="Direct link to Enable CloudTrail Insights for Anomaly Detection">​</a></h3>
<p>Activate CloudTrail Insights to detect unusual API activity, such as spikes in CreateUser or AssumeRole calls, which may indicate compromise.</p>
<p><strong>Configuration</strong>: Configure Insights to deliver events to an S3 bucket or CloudTrail Lake event data store, and integrate with Amazon EventBridge to trigger alerts or Lambda functions for automated responses.</p>
<p><strong>Example</strong>: An Insights event for excessive GetCallerIdentity calls could trigger an email notification to the security team.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitor-and-alert-on-suspicious-activity-in-real-time">Monitor and Alert on Suspicious Activity in Real Time<a href="#monitor-and-alert-on-suspicious-activity-in-real-time" class="hash-link" aria-label="Direct link to Monitor and Alert on Suspicious Activity in Real Time" title="Direct link to Monitor and Alert on Suspicious Activity in Real Time">​</a></h3>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Stream CloudTrail Events to CloudWatch</div><div class="admonitionContent_BuS1"><p><strong>Integrate AWS CloudTrail with Amazon CloudWatch Logs</strong> for near real-time monitoring of security events. <strong><a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/send-cloudtrail-events-to-cloudwatch-logs.html" target="_blank" rel="noopener noreferrer">Learn how to configure event streaming in our documentation</a></strong>.</p></div></div>
<p><strong>Implementation</strong>: Use CloudWatch Logs Insights to query logs and set up alarms for high-risk events, such as Root logins or failed authentication attempts.</p>
<p><strong>Example CloudWatch alarm using metric filters</strong>: Create an alarm to notify the security team when:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{ ($.eventName = ConsoleLogin) &amp;&amp; ($.errorMessage = &quot;Failed authentication&quot;) }</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Monitor IAM Policy Changes</div><div class="admonitionContent_BuS1"><p><strong>Set up CloudWatch alarms for AWS CloudTrail</strong> to detect IAM policy changes. <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html#cloudwatch-alarms-for-cloudtrail-iam-policy-changes" target="_blank" rel="noopener noreferrer">Learn how in the AWS documentation</a>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="log-security-and-integrity">Log Security and Integrity<a href="#log-security-and-integrity" class="hash-link" aria-label="Direct link to Log Security and Integrity" title="Direct link to Log Security and Integrity">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="secure-cloudtrail-logs-with-robust-controls">Secure CloudTrail Logs with Robust Controls<a href="#secure-cloudtrail-logs-with-robust-controls" class="hash-link" aria-label="Direct link to Secure CloudTrail Logs with Robust Controls" title="Direct link to Secure CloudTrail Logs with Robust Controls">​</a></h3>
<p>Protect CloudTrail logs to ensure their integrity and availability for forensic analysis:</p>
<ol>
<li>
<p><strong>Centralized Storage</strong>: Store logs in a centralized S3 bucket in a separate AWS account with restricted access to prevent unauthorized modifications.</p>
</li>
<li>
<p><strong>Deletion Protection</strong>: Enable MFA-delete or S3 Object Lock and versioning on the S3 bucket to prevent accidental or malicious deletion of logs.</p>
</li>
<li>
<p><strong>Encryption</strong>: Encrypt logs at rest using AWS KMS-managed keys (SSE-KMS) to protect sensitive data. Use Amazon S3 Bucket Keys to reduce KMS request costs.</p>
</li>
<li>
<p><strong>Integrity Validation</strong>: Enable log file integrity validation using SHA-256 hashing and RSA signing to detect tampering or deletion, ensuring logs are reliable for forensic investigations.</p>
</li>
</ol></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/CloudTrail Security/event-fields"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Understand the Security Importance of CloudTrail Event Fields</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cloud-operations-best-practices/docs/recipes/AWS CloudTrail/CloudTrail Security/additional-resources"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">AWS CloudTrail Security Resources</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#comprehensive-logging-configuration" class="table-of-contents__link toc-highlight">Comprehensive Logging Configuration</a><ul><li><a href="#enable-comprehensive-logging-across-all-regions-and-accounts" class="table-of-contents__link toc-highlight">Enable Comprehensive Logging Across All Regions and Accounts</a></li><li><a href="#use-advanced-event-selectors-to-focus-on-high-risk-data-events" class="table-of-contents__link toc-highlight">Use Advanced Event Selectors to Focus on High-Risk Data Events</a></li></ul></li><li><a href="#log-analysis-and-querying" class="table-of-contents__link toc-highlight">Log Analysis and Querying</a><ul><li><a href="#use-cloudtrail-lake-for-advanced-querying" class="table-of-contents__link toc-highlight">Use CloudTrail Lake for Advanced Querying</a></li><li><a href="#integrate-with-amazon-athena-for-efficient-log-analysis" class="table-of-contents__link toc-highlight">Integrate with Amazon Athena for Efficient Log Analysis</a></li></ul></li><li><a href="#monitoring-and-detection" class="table-of-contents__link toc-highlight">Monitoring and Detection</a><ul><li><a href="#enable-cloudtrail-insights-for-anomaly-detection" class="table-of-contents__link toc-highlight">Enable CloudTrail Insights for Anomaly Detection</a></li><li><a href="#monitor-and-alert-on-suspicious-activity-in-real-time" class="table-of-contents__link toc-highlight">Monitor and Alert on Suspicious Activity in Real Time</a></li></ul></li><li><a href="#log-security-and-integrity" class="table-of-contents__link toc-highlight">Log Security and Integrity</a><ul><li><a href="#secure-cloudtrail-logs-with-robust-controls" class="table-of-contents__link toc-highlight">Secure CloudTrail Logs with Robust Controls</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Built with ❤️ at AWS. <br> © 2025.  Amazon.com, Inc. or its affiliates. All Rights Reserved.</div></div></div></footer></div>
</body>
</html>