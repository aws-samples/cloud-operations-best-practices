"use strict";(globalThis.webpackChunkaws_cloud_operations_best_practices=globalThis.webpackChunkaws_cloud_operations_best_practices||[]).push([[4342],{2802(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"guides/AWS Config/AWS Config Cost Optimization/index","title":"AWS Config Cost Optimization","description":"Pricing","source":"@site/docs/guides/AWS Config/AWS Config Cost Optimization/index.md","sourceDirName":"guides/AWS Config/AWS Config Cost Optimization","slug":"/guides/AWS Config/AWS Config Cost Optimization/","permalink":"/cloud-operations-best-practices/docs/guides/AWS Config/AWS Config Cost Optimization/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Compliance Evaluation","permalink":"/cloud-operations-best-practices/docs/guides/AWS Config/Compliance Evaluation/"},"next":{"title":"AWS Control Tower","permalink":"/cloud-operations-best-practices/docs/guides/AWS Control Tower/"}}');var t=i(4848),s=i(8453);const a={sidebar_position:4},r="AWS Config Cost Optimization",c={},l=[{value:"Pricing",id:"pricing",level:3},{value:"Cost Optimization recommendations",id:"cost-optimization-recommendations",level:3},{value:"Analyzing Config Costs",id:"analyzing-config-costs",level:4},{value:"Choosing Between Continuous and Periodic Recording",id:"choosing-between-continuous-and-periodic-recording",level:4},{value:"Resource Exclusion",id:"resource-exclusion",level:4},{value:"Top Configuration Items",id:"top-configuration-items",level:4},{value:"AWS Config Indirect Relationship",id:"aws-config-indirect-relationship",level:4},{value:"Rule Management and Evaluation Considerations",id:"rule-management-and-evaluation-considerations",level:4},{value:"API Call Optimization",id:"api-call-optimization",level:4},{value:"Custom Rules and Lambda Function Optimization",id:"custom-rules-and-lambda-function-optimization",level:4},{value:"Conformance Pack and Rule Deduplication",id:"conformance-pack-and-rule-deduplication",level:4},{value:"Optimizing Global Resource Recording in AWS Config",id:"optimizing-global-resource-recording-in-aws-config",level:4},{value:"Integrated Services Optimization",id:"integrated-services-optimization",level:4}];function d(e){const n={a:"a",code:"code",h1:"h1",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"aws-config-cost-optimization",children:"AWS Config Cost Optimization"})}),"\n",(0,t.jsx)(n.h3,{id:"pricing",children:"Pricing"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://aws.amazon.com/config/pricing/",children:"AWS Config pricing"})," is primarily based on two main dimensions:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Configuration Item Recording :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Continuous Recording\nContinuously monitors and records every configuration change in your AWS environment in real-time. This provides comprehensive visibility into all resource modifications, allowing you to track and audit changes as they occur."}),"\n",(0,t.jsx)(n.li,{children:"Periodic Recording\nTakes daily snapshots of your resource configurations, recording changes only when they differ from the previous 24-hour state. This approach offers a balance between oversight and cost efficiency, capturing significant changes while reducing data volume."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Rule and Conformance Pack Evaluations:\nAWS Config charges for config rule evaluations, individual or as part of a conformance pack."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["For current details on AWS Config pricing, ",(0,t.jsx)(n.a,{href:"https://aws.amazon.com/config/pricing/",children:"please refer to this link"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"While the above are the primary pricing components, other factors can influence the total cost of using AWS Config:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://aws.amazon.com/lambda/pricing/",children:"AWS Lambda"})," costs: If you're using custom rules implemented via Lambda functions, standard Lambda pricing applies."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://aws.amazon.com/s3/pricing/",children:"Amazon S3"})," storage: Costs are incurred for storing configuration snapshots and history files in S3."]}),"\n",(0,t.jsx)(n.li,{children:"Data Transfer: Charges may apply for data transfer between AWS services or regions."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"cost-optimization-recommendations",children:"Cost Optimization recommendations"}),"\n",(0,t.jsx)(n.h4,{id:"analyzing-config-costs",children:"Analyzing Config Costs"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://aws.amazon.com/aws-cost-management/aws-cost-explorer/",children:"AWS Cost Explorer"})," provides insights into AWS Config costs by filtering service usage and analyzing cost dimensions.  To do so, navigate to your  ",(0,t.jsx)(n.a,{href:"https://us-east-1.console.aws.amazon.com/costmanagement/home#/home",children:"Billing and Cost Management console"})," and select ",(0,t.jsx)(n.strong,{children:"Cost Explorer"})," from left panel. From right panel, configure parameters such as your desired time and choose your preferred granularity (daily or monthly) based on the level of detail you need. Select ",(0,t.jsx)(n.strong,{children:"Usage Type"})," from ",(0,t.jsx)(n.strong,{children:"Dimensions"})," under ",(0,t.jsx)(n.strong,{children:"Group by"})," section. Under ",(0,t.jsx)(n.strong,{children:"Filters"}),", navigate to ",(0,t.jsx)(n.strong,{children:"Service"})," and choose ",(0,t.jsx)(n.strong,{children:"Config"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"AWS Config Cost Visualization",src:i(584).A+"",width:"1909",height:"831"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://aws.amazon.com/cloudwatch/",children:"Amazon CloudWatch's"}),' "ConfigurationItemsRecorded" metric helps identify resource types generating the most configuration items.  Please refer to blog on ',(0,t.jsx)(n.a,{href:"https//aws.amazon.com/blogs/mt/analyzing-aws-config-resource-changes-using-cloudwatch-metrics/",children:"how to analyze AWS Config Resource Changes Using CloudWatch Metrics"}),".  For detailed analysis, ",(0,t.jsx)(n.a,{href:"https://aws.amazon.com/athena/",children:"Amazon Athena"})," can be used to query ",(0,t.jsx)(n.a,{href:"https://aws.amazon.com/aws-cost-management/aws-cost-and-usage-reporting/",children:"Cost and Usage Reports"})," with ",(0,t.jsx)(n.a,{href:"https://aws.amazon.com/cloudtrail/",children:"AWS CloudTrail"})," and ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-lake.html",children:"CloudTrail Lake"})," to help estimate config recorder costs and track frequently evaluated rules. Please refer to blog on how to ",(0,t.jsx)(n.a,{href:"https://aws.amazon.com/blogs/mt/use-amazon-athena-and-aws-cloudtrail-to-estimate-billing-for-aws-config-rule-evaluations/",children:"use Athena to Analyze AWS Config Data"})]}),"\n",(0,t.jsxs)(n.p,{children:["For cost alerts,  implement proactive cost management through ",(0,t.jsx)(n.a,{href:"https://aws.amazon.com/aws-cost-management/aws-budgets/",children:"AWS Budgets"})," when costs exceed predefined thresholds.  Also, ",(0,t.jsx)(n.a,{href:"https://aws.amazon.com/aws-cost-management/aws-cost-anomaly-detection/",children:"AWS Cost Anomaly Detection"})," service provides continuous monitoring for unusual spending patterns, making it easier to identify and address cost spikes quickly. You can also create ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/monitor_estimated_charges_with_cloudwatch.html",children:"CloudWatch billing alarms"})," that notify you when your estimated charges exceed a defined threshold."]}),"\n",(0,t.jsx)(n.h4,{id:"choosing-between-continuous-and-periodic-recording",children:"Choosing Between Continuous and Periodic Recording"}),"\n",(0,t.jsxs)(n.p,{children:["When implementing AWS Config, selecting the appropriate recording method is crucial for balancing costs with compliance requirements. ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/config/latest/developerguide/config-concepts.html#continuous-recording",children:"Continuous recording"})," is often more cost-effective for static workloads where resources remain relatively stable over time. This option is particularly recommended for environments with stringent security and compliance requirements that demand real-time monitoring and immediate visibility into configuration changes. Critical infrastructure components, such as production databases, core networking resources, or sensitive data processing systems, typically benefit from continuous recording. On the other hand, ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/config/latest/developerguide/config-concepts.html#periodic-recording",children:"periodic recording"})," can be more economical for highly dynamic workloads, such as ephemeral resources in containerized environments or infrastructure that frequently scales up and down. Examples include development environments using auto-scaling groups, container orchestration platforms, or temporary testing environments. However, it's important to note that periodic recording should only be implemented for workloads with lower compliance requirements, as it provides updates on a 24-hour basis rather than in real-time. Also for periodic recording, the cost per configuration item delivered is higher than in continuous recording, so in certain scenarios, the total cost of periodic recording might actually exceed that of continuous recording. The choice between these recording methods often aligns with specific use cases, such as operational planning where periodic snapshots might suffice, or compliance auditing where continuous monitoring is necessary. Organizations should carefully evaluate their security requirements, operational patterns, and budget constraints when making this decision."]}),"\n",(0,t.jsx)(n.h4,{id:"resource-exclusion",children:"Resource Exclusion"}),"\n",(0,t.jsxs)(n.p,{children:["AWS Config offers cost optimization through ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/config/latest/developerguide/select-resources.html",children:"resource exclusion"})," capability, allowing organizations to strategically manage their configuration monitoring costs. By excluding specific resource types that are less relevant to your risk profile or those generating high volumes of configuration items, you can significantly reduce costs while maintaining essential security monitoring. This feature can be accessed and configured through the AWS Config settings in the AWS Management Console and CLI. However, you should approach resource exclusion with careful consideration and proper stakeholder involvement. Organizations should engage their security and operations teams to conduct a thorough assessment of which resources are critical for monitoring and compliance requirements, and which can be safely excluded. The goal is to strike an optimal balance between cost efficiency and maintaining robust governance posture. For example, while temporary development resources might be candidates for exclusion, critical production infrastructure should typically remain under continuous monitoring. Before implementing any exclusions, it's recommended to review ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/config/latest/developerguide/security-best-practices.html",children:"AWS's Security Best Practices"})," and consult the ",(0,t.jsx)(n.a,{href:"https://aws.amazon.com/architecture/well-architected/",children:"AWS Well-Architected Framework"})," to ensure your decisions align with security and compliance requirements. Additionally, organizations should regularly review their exclusion policies as business needs and security requirements evolve over time."]}),"\n",(0,t.jsxs)(n.p,{children:["It's worth noting that ",(0,t.jsx)(n.a,{href:"https://aws.amazon.com/controltower/",children:"AWS Control Tower"})," currently doesn't support config recorder customization. However, there is a workaround as ",(0,t.jsx)(n.a,{href:"https://aws.amazon.com/blogs/mt/customize-aws-config-resource-tracking-in-aws-control-tower-environment/",children:"outlined in this blog"})," for customizing AWS Config resource tracking in Control Tower environments until native support is added."]}),"\n",(0,t.jsx)(n.h4,{id:"top-configuration-items",children:"Top Configuration Items"}),"\n",(0,t.jsxs)(n.p,{children:["At times ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/config/latest/developerguide/view-compliance-history.html",children:"AWS::Config::ResourceCompliance"})," is often one of the most impactful CI generators, especially for customers with numerous rule evaluations. This resource type provides a timeline view of compliance status in the AWS Config console. While it offers valuable insights, it can significantly increase configuration item costs, particularly when evaluating large resources. If that is the case, you can consider its exclusion to reduce costs."]}),"\n",(0,t.jsx)(n.p,{children:"For historical compliance checks, customers can utilize CloudTrail data as a cost-free alternative. Your customers can alter the below query to work with either Athena, 3rd party solutions, or use it in CloudTrail Lake if they have it enabled."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"SELECT\n    eventTime,awsRegion, recipientAccountId, element_at(additionalEventData, 'configRuleName'\n    ) as configRuleName, json_extract_scalar(json_array_get(element_at(requestParameters,'evaluations'\n        ),0\n        ),'$.complianceType'\n    ) as Compliance, json_extract_scalar(json_array_get(element_at(requestParameters,'evaluations'\n        ),0\n        ),'$.complianceResourceType'\n    ) as ResourceType, json_extract_scalar(json_array_get(element_at(requestParameters,'evaluations'\n        ),0\n        ),'$.complianceResourceId'\n    ) as ResourceName\nFROM\n    $EDS_ID\nWHERE\n    eventName='PutEvaluations'\n    and eventTime > '2022-03-17 00:00:00'\n    AND eventTime < '2022-03-18 00:00:00'\n    And json_extract_scalar(json_array_get(element_at(requestParameters,'evaluations'\n        ),0\n        ),'$.complianceType'\n    ) IN ('COMPLIANT','NON_COMPLIANT')\n"})}),"\n",(0,t.jsx)(n.h4,{id:"aws-config-indirect-relationship",children:"AWS Config Indirect Relationship"}),"\n",(0,t.jsx)(n.p,{children:"There are two types of relationships AWS Config:\nDirect Relationships:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Straightforward A\u2192B relationship extracted from a  resource's configuration data"}),"\n",(0,t.jsx)(n.li,{children:"Pulled directly from the describe API calls"}),"\n",(0,t.jsx)(n.li,{children:"Example: The relationship between an Amazon EC2  instance and its security group is direct because the security groups are  included in the describe API response for the Amazon EC2 instance."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Indirect Relationships:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Older resource types might have their configuration recorded  by examining multiple resources configurations"}),"\n",(0,t.jsx)(n.li,{children:"Example: The relationship between a security  group and an Amazon EC2 instance is indirect because describing a security  group does not return any information about the instances it is associated  with. In this case AWS Config  creates two configuration items."}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["You can learn more about what resources support indirect relationships ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/config/latest/developerguide/faq.html",children:"in this link"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["To opt out of indirect relationships,  we recommend you reach out to your ",(0,t.jsx)(n.a,{href:"https://aws.amazon.com/premiumsupport/plans/enterprise/",children:"Technical Account Manager"}),"."]}),"\n",(0,t.jsx)(n.h4,{id:"rule-management-and-evaluation-considerations",children:"Rule Management and Evaluation Considerations"}),"\n",(0,t.jsxs)(n.p,{children:["When managing AWS Config rules, consider rule deletion and re-evaluation actions, as these can significantly impact costs. When deleting rules that evaluate large numbers of resources, a cost-effective approach is to first stop ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/config/latest/developerguide/stop-start-recorder.html",children:"resource compliance recording"}),", then delete the rules, and finally restart the compliance recording. This action will not impact your stored data but will impact your visibility into resource configuration while recorder is stopped. This sequential process helps prevent unnecessary spikes in configuration item generation and associated costs."]}),"\n",(0,t.jsx)(n.h4,{id:"api-call-optimization",children:"API Call Optimization"}),"\n",(0,t.jsxs)(n.p,{children:["Efficient API operations can reduce AWS Config costs. When modifying resources, such as adding multiple tags to an ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Using_Tags.html",children:"EC2 instance"}),", it's recommended to consolidate changes into a single API call rather than making multiple individual calls. For example, adding 10 tags in one API call is more efficient than making 10 separate calls, as each call generates both an API change record and a resource compliance configuration item."]}),"\n",(0,t.jsx)(n.h4,{id:"custom-rules-and-lambda-function-optimization",children:"Custom Rules and Lambda Function Optimization"}),"\n",(0,t.jsxs)(n.p,{children:["For custom rule implementation, using ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/cfn-guard/latest/ug/what-is-guard.html",children:"CloudFormation Guard"})," is preferred over Lambda functions to reduce execution costs. However, if Lambda-based custom rules are necessary, optimize them by:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Narrowing the scope of evaluated resources using specific targeting. Scope based rules are only supported for event-based evaluations not periodic"}),"\n",(0,t.jsx)(n.li,{children:"Implementing resource tagging for better control"}),"\n",(0,t.jsx)(n.li,{children:"Adding logic to handle the termination of evaluation for deleted resources"}),"\n",(0,t.jsx)(n.li,{children:"Using resource-specific triggers rather than evaluating all resources"}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"conformance-pack-and-rule-deduplication",children:"Conformance Pack and Rule Deduplication"}),"\n",(0,t.jsxs)(n.p,{children:["Regular auditing of rules and ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/config/latest/developerguide/conformance-packs.html",children:"conformance packs"})," is essential to eliminate redundancy.  For instance, if multiple conformance packs include the same rule (such as CloudTrail enablement checks) that's already being evaluated by ",(0,t.jsx)(n.a,{href:"https://aws.amazon.com/security-hub/",children:"AWS Security Hub"}),", consider removing the duplicate rules to avoid unnecessary evaluation costs. Review and consolidate overlapping rules across different compliance standards to maintain effectiveness while optimizing costs. Please follow ",(0,t.jsx)(n.a,{href:"https://aws.amazon.com/blogs/security/discover-duplicate-aws-config-rules-for-streamlined-compliance/",children:"this blog to discover duplicate AWS Config rules"}),"."]}),"\n",(0,t.jsx)(n.h4,{id:"optimizing-global-resource-recording-in-aws-config",children:"Optimizing Global Resource Recording in AWS Config"}),"\n",(0,t.jsx)(n.p,{children:"When implementing AWS Config across multiple regions, you can optimize the recording of global resources to control costs and prevent duplicate data collection. The best practice is to limit global resource recording to a single region within your AWS environment. This can be managed through AWS CloudFormation templates by setting the 'IncludeGlobalResourceTypes' property to 'true' in only one designated region. This approach is important for resources like IAM users, roles, and policies that are global in nature. By implementing this approach, organizations can avoid unnecessary duplication of global resource recording across multiple regions, leading to significant cost savings while maintaining comprehensive visibility into their global resources."}),"\n",(0,t.jsx)(n.h4,{id:"integrated-services-optimization",children:"Integrated Services Optimization"}),"\n",(0,t.jsx)(n.p,{children:"AWS Config interacts with various AWS services, each contributing to the overall cost. Implement best practices for these integrated services to optimize their individual costs:"})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},584(e,n,i){i.d(n,{A:()=>o});const o=i.p+"assets/images/configcost-9da3b66e48c0674a4436403f4770d778.png"},8453(e,n,i){i.d(n,{R:()=>a,x:()=>r});var o=i(6540);const t={},s=o.createContext(t);function a(e){const n=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);